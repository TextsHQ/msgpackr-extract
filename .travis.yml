sudo: false
language: node_js
node_js:
- node
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - g++-4.8
    - gcc-4.8-multilib
    - g++-4.8-multilib
    - gcc-multilib
    - g++-multilib
os:
- osx
- linux
before_deploy:
- ARCHIVE_NAME="${TRAVIS_TAG:-latest}-$TRAVIS_OS_NAME-`uname -m`.tar"
- npm run prebuild
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then ARCH=ia32 npm run prebuild; fi
- tar --create --verbose --file="$ARCHIVE_NAME" --directory "$TRAVIS_BUILD_DIR/prebuilds"
  .
deploy:
  provider: releases
  draft: false
  prerelease: true
  file: "$ARCHIVE_NAME"
  skip_cleanup: true
  on:
    tags: true
    node: node
  api_key:
    secure: "NEB3UQD3aVEV1pI1W/+Ss56j5RdEhkodnQAdNTwD2jRVUSPQNoVDHVoPpBluCmK3LWT1rFnv2d5gkIghYiwzS6Z/7HqG3oylMEJ+60H2Wx/PevF6q1r3dWslQpTorJLCnXz6gewpnz4na9YF9xVBqj4W7Sh2OPCHbSFI6r1Folj/oSHm9jorGjTlFl0rjayD89ZFc62qyVgrblseSvvTMTPvmOYIgP/EStgzwgarIjf7HazXyA0yVJshYMbQCKk1kd9At4d8aO37fIhsqtxEh2LL7aRHAr8Nt01dbAYx3IAmlyvaNFYEjaC/+MRB7KAeyPxM2KlnCzi1juf0z18gqyDFS6T8CqB9OJEulBXKFjJ2bdbipYlUZ8erLj39ZHXvzITlW79n8iy2en2qmULdKqzfg5ArP6r6/AEOX3HEUeJqdRtk847sVohmF1nLIXbwEMtv1FNjALzPougnIE760tkiXL0ob5XTkaV4KZoNu+jKGK/Ni/+c1YccJ2LcQrnSwLSoyaTtGOVA/kB/nzgx/kvdQ5EmeMZy7kEO1xG0OdzrYuiYyLK48zzZ2w2uKVc7sCf24XPU3HG1pmojaM0NXulJ7zfj1lydQbBGiEnWPvaCMbFPV++NfkBQuta9ign/zBBwlB/2RQiOZoy5VoaiCvwdmXbK/4PNPxhah1XXZTY="
